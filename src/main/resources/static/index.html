<!DOCTYPE html>
<html>
<head>
    <title>Library App</title>
    <style>
        body { font-family: Arial; margin: 40px; }
        input, button { padding: 6px; margin: 4px; }
        table { border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #333; padding: 8px; }
    </style>
</head>
<body>

<h2> Library Management</h2>

<h3>Add Book</h3>
<input id="id" placeholder="ID">
<input id="title" placeholder="Title">
<input id="author" placeholder="Author">
<input id="year" placeholder="Year">
<button onclick="addBook()">Add Book</button>

<p id="msg"></p>

<hr>

<h3>All Books</h3>
<button onclick="loadBooks()">Load All Books</button>

<table id="bookTable">
    <thead>
        <tr>
            <th>ID</th>
            <th>Title</th>
            <th>Author</th>
            <th>Year</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

<script>
function addBook() {
    fetch("/books", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
            id: document.getElementById("id").value,
            title: document.getElementById("title").value,
            author: document.getElementById("author").value,
            year: document.getElementById("year").value
        })
    })
    .then(res => res.text())
    .then(data => {
        document.getElementById("msg").innerText = data;
        loadBooks(); // auto refresh list
    });
}

function loadBooks() {
    fetch("/books")
    .then(res => res.json())
    .then(data => {
        const tbody = document.querySelector("#bookTable tbody");
        tbody.innerHTML = "";
        data.forEach(book => {
            tbody.innerHTML += `
                <tr>
                    <td>${book.id}</td>
                    <td>${book.title}</td>
                    <td>${book.author}</td>
                    <td>${book.year}</td>
                </tr>`;
        });
    });
}
</script>

</body>
</html>
